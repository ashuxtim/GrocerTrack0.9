"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[852],{2852:(e,t,r)=>{r.r(t),r.d(t,{default:()=>D});var a=r(9379),n=r(5043),s=r(9722),i=r(7488),c=r(3969),l=r(5895),o=r(998),d=r(1244),u=r(6128),h=r(6154),p=r(2097),A=r(256),x=r(9067),j=r(4481),m=r(7471),v=r(5315),f=r(2394),g=r(6647),y=r(6185),S=r(3023),b=r(1911),C=r(8776),k=r(9200),q=r(5877),w=r(5362),P=r(579);const D=function(){const[e,t]=(0,n.useState)([]),[r,D]=(0,n.useState)([]),[_,R]=(0,n.useState)([]),[B,N]=(0,n.useState)(""),[W,F]=(0,n.useState)({supplier:"",variant:"",quantity:"",purchase_price:""}),[T,V]=(0,n.useState)(!1),[E,H]=(0,n.useState)(null),L=()=>{s.A.get("http://localhost:8000/api/suppliers/").then(e=>t(e.data)),s.A.get("http://localhost:8000/api/variants/").then(e=>D(e.data)),s.A.get("http://localhost:8000/api/purchases/").then(e=>R(e.data.sort((e,t)=>new Date(t.purchase_date)-new Date(e.purchase_date))))};(0,n.useEffect)(()=>{L()},[]);const O=()=>{V(!1),H(null)},Q=e=>{const t=r.find(t=>t.id===e);return t?"".concat(t.product_name," (").concat(t.name,")"):"Unknown"},U=e=>{F((0,a.A)((0,a.A)({},W),{},{[e.target.name]:e.target.value}))};return(0,P.jsxs)(c.A,{children:[(0,P.jsx)(l.A,{variant:"h2",gutterBottom:!0,children:"\ud83d\udce5 Suppliers & Purchases"}),(0,P.jsxs)(o.A,{container:!0,spacing:3,children:[(0,P.jsx)(o.A,{item:!0,xs:12,md:6,children:(0,P.jsx)(d.A,{children:(0,P.jsxs)(u.A,{children:[(0,P.jsx)(l.A,{variant:"h3",gutterBottom:!0,children:"Add New Supplier"}),(0,P.jsxs)(c.A,{component:"form",onSubmit:e=>{e.preventDefault(),s.A.post("http://localhost:8000/api/suppliers/",{name:B}).then(()=>{i.oR.success("Supplier added!"),N(""),L()})},sx:{display:"flex",gap:2},children:[(0,P.jsx)(h.A,{label:"Supplier Name",value:B,onChange:e=>N(e.target.value),required:!0,fullWidth:!0}),(0,P.jsx)(p.A,{type:"submit",variant:"contained",children:"Add"})]})]})})}),(0,P.jsx)(o.A,{item:!0,xs:12,md:6,children:(0,P.jsx)(d.A,{children:(0,P.jsxs)(u.A,{children:[(0,P.jsx)(l.A,{variant:"h3",gutterBottom:!0,children:"Record New Purchase"}),(0,P.jsxs)(c.A,{component:"form",onSubmit:e=>{e.preventDefault(),s.A.post("http://localhost:8000/api/purchases/",W).then(()=>{i.oR.success("Purchase recorded! Stock updated."),F({supplier:"",variant:"",quantity:"",purchase_price:""}),L()})},sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,P.jsxs)(A.A,{fullWidth:!0,children:[(0,P.jsx)(x.A,{children:"Supplier"}),(0,P.jsx)(j.A,{name:"supplier",value:W.supplier,label:"Supplier",onChange:U,required:!0,children:e.map(e=>(0,P.jsx)(m.A,{value:e.id,children:e.name},e.id))})]}),(0,P.jsxs)(A.A,{fullWidth:!0,children:[(0,P.jsx)(x.A,{children:"Product Variant"}),(0,P.jsx)(j.A,{name:"variant",value:W.variant,label:"Product Variant",onChange:U,required:!0,children:r.map(e=>(0,P.jsx)(m.A,{value:e.id,children:Q(e.id)},e.id))})]}),(0,P.jsx)(h.A,{name:"quantity",label:"Quantity",type:"number",value:W.quantity,onChange:U,required:!0}),(0,P.jsx)(h.A,{name:"purchase_price",label:"Total Purchase Price",type:"number",value:W.purchase_price,onChange:U,required:!0}),(0,P.jsx)(p.A,{type:"submit",variant:"contained",children:"Record Purchase"})]})]})})}),(0,P.jsx)(o.A,{item:!0,xs:12,children:(0,P.jsx)(d.A,{children:(0,P.jsxs)(u.A,{children:[(0,P.jsx)(l.A,{variant:"h3",gutterBottom:!0,children:"Purchase History"}),(0,P.jsx)(v.A,{children:_.map(e=>(0,P.jsx)(f.Ay,{secondaryAction:(0,P.jsx)(g.A,{edge:"end",onClick:()=>{return t=e.id,H({id:t}),void V(!0);var t},children:(0,P.jsx)(w.A,{color:"error"})}),children:(0,P.jsx)(y.A,{primary:"".concat(e.quantity," units of ").concat(Q(e.variant)),secondary:"On ".concat(new Date(e.purchase_date).toLocaleDateString()," for \u20b9").concat(e.purchase_price)})},e.id))})]})})})]}),(0,P.jsxs)(S.A,{open:T,onClose:O,children:[(0,P.jsx)(b.A,{children:"Confirm Deletion"}),(0,P.jsx)(C.A,{children:(0,P.jsx)(k.A,{children:"Are you sure you want to delete this purchase record? This action will update the product stock and cannot be undone."})}),(0,P.jsxs)(q.A,{children:[(0,P.jsx)(p.A,{onClick:O,children:"Cancel"}),(0,P.jsx)(p.A,{onClick:()=>{E&&s.A.delete("http://localhost:8000/api/purchases/".concat(E.id,"/")).then(()=>{i.oR.success("Purchase record deleted!"),L()}).catch(e=>{i.oR.error("Failed to delete purchase."),console.error(e)}).finally(()=>{O()})},color:"error",autoFocus:!0,children:"Delete"})]})]})]})}}}]);
//# sourceMappingURL=852.3d6e82f7.chunk.js.map