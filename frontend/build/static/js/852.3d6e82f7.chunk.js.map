{"version":3,"file":"static/js/852.3d6e82f7.chunk.js","mappings":"sYAuJA,QA7IA,WACI,MAAOA,EAAWC,IAAgBC,EAAAA,EAAAA,UAAS,KACpCC,EAAUC,IAAeF,EAAAA,EAAAA,UAAS,KAClCG,EAAWC,IAAgBJ,EAAAA,EAAAA,UAAS,KACpCK,EAAcC,IAAmBN,EAAAA,EAAAA,UAAS,KAC1CO,EAAcC,IAAmBR,EAAAA,EAAAA,UAAS,CAAES,SAAU,GAAIC,QAAS,GAAIC,SAAU,GAAIC,eAAgB,MAGrGC,EAAYC,IAAiBd,EAAAA,EAAAA,WAAS,IACtCe,EAAcC,IAAmBhB,EAAAA,EAAAA,UAAS,MAE3CiB,EAAYA,KACdC,EAAAA,EAAMC,IAAI,wCAAwCC,KAAKC,GAAOtB,EAAasB,EAAIC,OAC/EJ,EAAAA,EAAMC,IAAI,uCAAuCC,KAAKC,GAAOnB,EAAYmB,EAAIC,OAC7EJ,EAAAA,EAAMC,IAAI,wCAAwCC,KAAKC,GAAOjB,EAAaiB,EAAIC,KAAKC,KAAK,CAACC,EAAGC,IAAM,IAAIC,KAAKD,EAAEE,eAAiB,IAAID,KAAKF,EAAEG,oBAE9IC,EAAAA,EAAAA,WAAU,KAAQX,KAAgB,IAGlC,MAIMY,EAAoBA,KACtBf,GAAc,GACdE,EAAgB,OAkBdc,EAAkBC,IACpB,MAAMrB,EAAUT,EAAS+B,KAAKC,GAAKA,EAAEF,KAAOA,GAC5C,OAAOrB,EAAO,GAAAwB,OAAMxB,EAAQyB,aAAY,MAAAD,OAAKxB,EAAQ0B,KAAI,KAAM,WAE7DC,EAAqBC,IACvB9B,GAAe+B,EAAAA,EAAAA,IAAAA,EAAAA,EAAAA,GAAC,CAAC,EAAIhC,GAAY,IAAE,CAAC+B,EAAEE,OAAOJ,MAAOE,EAAEE,OAAOC,UAsBjE,OACIC,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAAAC,SAAA,EACAC,EAAAA,EAAAA,KAACC,EAAAA,EAAU,CAACpC,QAAQ,KAAKqC,cAAY,EAAAH,SAAC,wCACtCF,EAAAA,EAAAA,MAACM,EAAAA,EAAI,CAACC,WAAS,EAACC,QAAS,EAAEN,SAAA,EAEtBC,EAAAA,EAAAA,KAACG,EAAAA,EAAI,CAACG,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAET,UAACC,EAAAA,EAAAA,KAACS,EAAAA,EAAI,CAAAV,UAACF,EAAAA,EAAAA,MAACa,EAAAA,EAAW,CAAAX,SAAA,EACzCC,EAAAA,EAAAA,KAACC,EAAAA,EAAU,CAACpC,QAAQ,KAAKqC,cAAY,EAAAH,SAAC,sBACtCF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACa,UAAU,OAAOC,SA3BXnB,IACvBA,EAAEoB,iBACFxC,EAAAA,EAAMyC,KAAK,uCAAwC,CAAEvB,KAAM/B,IACtDe,KAAK,KACFwC,EAAAA,GAAMC,QAAQ,mBACdvD,EAAgB,IAChBW,OAqBuD6C,GAAI,CAAEC,QAAS,OAAQC,IAAK,GAAIpB,SAAA,EAC/EC,EAAAA,EAAAA,KAACoB,EAAAA,EAAS,CAACC,MAAM,gBAAgBzB,MAAOpC,EAAc8D,SAAU7B,GAAKhC,EAAgBgC,EAAEE,OAAOC,OAAQ2B,UAAQ,EAACC,WAAS,KACxHxB,EAAAA,EAAAA,KAACyB,EAAAA,EAAM,CAACC,KAAK,SAAS7D,QAAQ,YAAWkC,SAAC,mBAGlDC,EAAAA,EAAAA,KAACG,EAAAA,EAAI,CAACG,MAAI,EAACC,GAAI,GAAIC,GAAI,EAAET,UAACC,EAAAA,EAAAA,KAACS,EAAAA,EAAI,CAAAV,UAACF,EAAAA,EAAAA,MAACa,EAAAA,EAAW,CAAAX,SAAA,EACxCC,EAAAA,EAAAA,KAACC,EAAAA,EAAU,CAACpC,QAAQ,KAAKqC,cAAY,EAAAH,SAAC,yBACtCF,EAAAA,EAAAA,MAACC,EAAAA,EAAG,CAACa,UAAU,OAAOC,SAzBRnB,IAC1BA,EAAEoB,iBACFxC,EAAAA,EAAMyC,KAAK,uCAAwCpD,GAC9Ca,KAAK,KACFwC,EAAAA,GAAMC,QAAQ,qCACdrD,EAAgB,CAAEC,SAAU,GAAIC,QAAS,GAAIC,SAAU,GAAIC,eAAgB,KAC3EK,OAmB0D6C,GAAI,CAAEC,QAAS,OAAQS,cAAe,SAAUR,IAAK,GAAIpB,SAAA,EAC3GF,EAAAA,EAAAA,MAAC+B,EAAAA,EAAW,CAACJ,WAAS,EAAAzB,SAAA,EAACC,EAAAA,EAAAA,KAAC6B,EAAAA,EAAU,CAAA9B,SAAC,cAC/BC,EAAAA,EAAAA,KAAC8B,EAAAA,EAAM,CAACvC,KAAK,WAAWK,MAAOlC,EAAaE,SAAUyD,MAAM,WAAWC,SAAU9B,EAAmB+B,UAAQ,EAAAxB,SACvG9C,EAAU8E,IAAIC,IAAKhC,EAAAA,EAAAA,KAACiC,EAAAA,EAAQ,CAAYrC,MAAOoC,EAAE9C,GAAGa,SAAEiC,EAAEzC,MAAtByC,EAAE9C,WAG7CW,EAAAA,EAAAA,MAAC+B,EAAAA,EAAW,CAACJ,WAAS,EAAAzB,SAAA,EAACC,EAAAA,EAAAA,KAAC6B,EAAAA,EAAU,CAAA9B,SAAC,qBAC/BC,EAAAA,EAAAA,KAAC8B,EAAAA,EAAM,CAACvC,KAAK,UAAUK,MAAOlC,EAAaG,QAASwD,MAAM,kBAAkBC,SAAU9B,EAAmB+B,UAAQ,EAAAxB,SAC5G3C,EAAS2E,IAAI3C,IAAKY,EAAAA,EAAAA,KAACiC,EAAAA,EAAQ,CAAYrC,MAAOR,EAAEF,GAAGa,SAAEd,EAAeG,EAAEF,KAArCE,EAAEF,WAG5Cc,EAAAA,EAAAA,KAACoB,EAAAA,EAAS,CAAC7B,KAAK,WAAW8B,MAAM,WAAWK,KAAK,SAAS9B,MAAOlC,EAAaI,SAAUwD,SAAU9B,EAAmB+B,UAAQ,KAC7HvB,EAAAA,EAAAA,KAACoB,EAAAA,EAAS,CAAC7B,KAAK,iBAAiB8B,MAAM,uBAAuBK,KAAK,SAAS9B,MAAOlC,EAAaK,eAAgBuD,SAAU9B,EAAmB+B,UAAQ,KACrJvB,EAAAA,EAAAA,KAACyB,EAAAA,EAAM,CAACC,KAAK,SAAS7D,QAAQ,YAAWkC,SAAC,+BAGlDC,EAAAA,EAAAA,KAACG,EAAAA,EAAI,CAACG,MAAI,EAACC,GAAI,GAAGR,UACdC,EAAAA,EAAAA,KAACS,EAAAA,EAAI,CAAAV,UACDF,EAAAA,EAAAA,MAACa,EAAAA,EAAW,CAAAX,SAAA,EACPC,EAAAA,EAAAA,KAACC,EAAAA,EAAU,CAACpC,QAAQ,KAAKqC,cAAY,EAAAH,SAAC,sBACtCC,EAAAA,EAAAA,KAACkC,EAAAA,EAAI,CAAAnC,SACDzC,EAAUyE,IAAII,IACXnC,EAAAA,EAAAA,KAACoC,EAAAA,GAAQ,CACLC,iBAEIrC,EAAAA,EAAAA,KAACsC,EAAAA,EAAU,CAACC,KAAK,MAAMC,QAASA,KAAMC,OA1FpDvD,EA0FqEiD,EAAEjD,GAzF7Ff,EAAgB,CAAEe,YAClBjB,GAAc,GAFQiB,OA0F2Ea,UACzDC,EAAAA,EAAAA,KAAC0C,EAAAA,EAAU,CAACC,MAAM,YAEzB5C,UAEDC,EAAAA,EAAAA,KAAC4C,EAAAA,EAAY,CACTC,QAAO,GAAAxD,OAAK8C,EAAErE,SAAQ,cAAAuB,OAAaJ,EAAekD,EAAEtE,UACpDiF,UAAS,MAAAzD,OAAQ,IAAIR,KAAKsD,EAAErD,eAAeiE,qBAAoB,eAAA1D,OAAS8C,EAAEpE,mBAVnEoE,EAAEjD,kBAoBzCW,EAAAA,EAAAA,MAACmD,EAAAA,EAAM,CAACC,KAAMjF,EAAYkF,QAASlE,EAAkBe,SAAA,EACjDC,EAAAA,EAAAA,KAACmD,EAAAA,EAAW,CAAApD,SAAC,sBACbC,EAAAA,EAAAA,KAACoD,EAAAA,EAAa,CAAArD,UACVC,EAAAA,EAAAA,KAACqD,EAAAA,EAAiB,CAAAtD,SAAC,6HAIvBF,EAAAA,EAAAA,MAACyD,EAAAA,EAAa,CAAAvD,SAAA,EACVC,EAAAA,EAAAA,KAACyB,EAAAA,EAAM,CAACe,QAASxD,EAAkBe,SAAC,YACpCC,EAAAA,EAAAA,KAACyB,EAAAA,EAAM,CAACe,QA5GIe,KACnBrF,GACLG,EAAAA,EAAMmF,OAAO,uCAADnE,OAAwCnB,EAAagB,GAAE,MAC9DX,KAAK,KACFwC,EAAAA,GAAMC,QAAQ,4BACd5C,MAEHqF,MAAMC,IACH3C,EAAAA,GAAM4C,MAAM,8BACZC,QAAQD,MAAMD,KACfG,QAAQ,KACP7E,OAiG0C2D,MAAM,QAAQmB,WAAS,EAAA/D,SAAC,mBAKlF,C","sources":["pages/PurchasesPage.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport axios from 'axios';\r\nimport { toast } from 'react-toastify';\r\nimport {\r\n    Box, Grid, Card, CardContent, Typography, TextField, Button,\r\n    FormControl, InputLabel, Select, MenuItem, List, ListItem, ListItemText,\r\n    IconButton, Dialog, DialogActions, DialogContent, DialogContentText, DialogTitle // New\r\n} from '@mui/material';\r\nimport DeleteIcon from '@mui/icons-material/Delete';\r\n\r\nfunction PurchasesPage() {\r\n    const [suppliers, setSuppliers] = useState([]);\r\n    const [variants, setVariants] = useState([]);\r\n    const [purchases, setPurchases] = useState([]);\r\n    const [supplierName, setSupplierName] = useState('');\r\n    const [purchaseData, setPurchaseData] = useState({ supplier: '', variant: '', quantity: '', purchase_price: '' });\r\n\r\n    // --- NEW STATE for dialog ---\r\n    const [dialogOpen, setDialogOpen] = useState(false);\r\n    const [itemToDelete, setItemToDelete] = useState(null); // Will hold { id }\r\n\r\n    const fetchData = () => {\r\n        axios.get('http://localhost:8000/api/suppliers/').then(res => setSuppliers(res.data));\r\n        axios.get('http://localhost:8000/api/variants/').then(res => setVariants(res.data));\r\n        axios.get('http://localhost:8000/api/purchases/').then(res => setPurchases(res.data.sort((a, b) => new Date(b.purchase_date) - new Date(a.purchase_date))));\r\n    };\r\n    useEffect(() => { fetchData(); }, []);\r\n    \r\n    // --- NEW DIALOG HANDLERS ---\r\n    const handleOpenDialog = (id) => {\r\n        setItemToDelete({ id });\r\n        setDialogOpen(true);\r\n    };\r\n    const handleCloseDialog = () => {\r\n        setDialogOpen(false);\r\n        setItemToDelete(null);\r\n    };\r\n    const handleConfirmDelete = () => {\r\n        if (!itemToDelete) return;\r\n        axios.delete(`http://localhost:8000/api/purchases/${itemToDelete.id}/`)\r\n            .then(() => {\r\n                toast.success('Purchase record deleted!');\r\n                fetchData();\r\n            })\r\n            .catch(err => {\r\n                toast.error('Failed to delete purchase.');\r\n                console.error(err);\r\n            }).finally(() => {\r\n                handleCloseDialog();\r\n            });\r\n    };\r\n\r\n    // ... (other handlers remain) ...\r\n    const getVariantName = (id) => {\r\n        const variant = variants.find(v => v.id === id);\r\n        return variant ? `${variant.product_name} (${variant.name})` : 'Unknown';\r\n    };\r\n    const handleInputChange = (e) => {\r\n        setPurchaseData({ ...purchaseData, [e.target.name]: e.target.value });\r\n    };\r\n    const handleAddSupplier = (e) => {\r\n        e.preventDefault();\r\n        axios.post('http://localhost:8000/api/suppliers/', { name: supplierName })\r\n            .then(() => {\r\n                toast.success('Supplier added!');\r\n                setSupplierName('');\r\n                fetchData();\r\n            });\r\n    };\r\n    const handleRecordPurchase = (e) => {\r\n        e.preventDefault();\r\n        axios.post('http://localhost:8000/api/purchases/', purchaseData)\r\n            .then(() => {\r\n                toast.success('Purchase recorded! Stock updated.');\r\n                setPurchaseData({ supplier: '', variant: '', quantity: '', purchase_price: '' });\r\n                fetchData();\r\n            });\r\n    };\r\n\r\n\r\n    return (\r\n        <Box>\r\n            <Typography variant=\"h2\" gutterBottom>ðŸ“¥ Suppliers & Purchases</Typography>\r\n            <Grid container spacing={3}>\r\n                {/* ... (Cards for forms remain the same) ... */}\r\n                 <Grid item xs={12} md={6}><Card><CardContent>\r\n                    <Typography variant=\"h3\" gutterBottom>Add New Supplier</Typography>\r\n                    <Box component=\"form\" onSubmit={handleAddSupplier} sx={{ display: 'flex', gap: 2 }}>\r\n                        <TextField label=\"Supplier Name\" value={supplierName} onChange={e => setSupplierName(e.target.value)} required fullWidth/>\r\n                        <Button type=\"submit\" variant=\"contained\">Add</Button>\r\n                    </Box>\r\n                </CardContent></Card></Grid>\r\n                <Grid item xs={12} md={6}><Card><CardContent>\r\n                    <Typography variant=\"h3\" gutterBottom>Record New Purchase</Typography>\r\n                    <Box component=\"form\" onSubmit={handleRecordPurchase} sx={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\r\n                        <FormControl fullWidth><InputLabel>Supplier</InputLabel>\r\n                            <Select name=\"supplier\" value={purchaseData.supplier} label=\"Supplier\" onChange={handleInputChange} required>\r\n                                {suppliers.map(s => <MenuItem key={s.id} value={s.id}>{s.name}</MenuItem>)}\r\n                            </Select>\r\n                        </FormControl>\r\n                        <FormControl fullWidth><InputLabel>Product Variant</InputLabel>\r\n                            <Select name=\"variant\" value={purchaseData.variant} label=\"Product Variant\" onChange={handleInputChange} required>\r\n                                {variants.map(v => <MenuItem key={v.id} value={v.id}>{getVariantName(v.id)}</MenuItem>)}\r\n                            </Select>\r\n                        </FormControl>\r\n                        <TextField name=\"quantity\" label=\"Quantity\" type=\"number\" value={purchaseData.quantity} onChange={handleInputChange} required />\r\n                        <TextField name=\"purchase_price\" label=\"Total Purchase Price\" type=\"number\" value={purchaseData.purchase_price} onChange={handleInputChange} required />\r\n                        <Button type=\"submit\" variant=\"contained\">Record Purchase</Button>\r\n                    </Box>\r\n                </CardContent></Card></Grid>\r\n                <Grid item xs={12}>\r\n                    <Card>\r\n                        <CardContent>\r\n                             <Typography variant=\"h3\" gutterBottom>Purchase History</Typography>\r\n                             <List>\r\n                                {purchases.map(p => (\r\n                                    <ListItem key={p.id}\r\n                                        secondaryAction={\r\n                                            // --- MODIFIED ---\r\n                                            <IconButton edge=\"end\" onClick={() => handleOpenDialog(p.id)}>\r\n                                                <DeleteIcon color=\"error\" />\r\n                                            </IconButton>\r\n                                        }\r\n                                    >\r\n                                        <ListItemText\r\n                                            primary={`${p.quantity} units of ${getVariantName(p.variant)}`}\r\n                                            secondary={`On ${new Date(p.purchase_date).toLocaleDateString()} for â‚¹${p.purchase_price}`}\r\n                                        />\r\n                                    </ListItem>\r\n                                ))}\r\n                             </List>\r\n                        </CardContent>\r\n                    </Card>\r\n                </Grid>\r\n            </Grid>\r\n             {/* --- NEW CONFIRMATION DIALOG --- */}\r\n            <Dialog open={dialogOpen} onClose={handleCloseDialog}>\r\n                <DialogTitle>Confirm Deletion</DialogTitle>\r\n                <DialogContent>\r\n                    <DialogContentText>\r\n                        Are you sure you want to delete this purchase record? This action will update the product stock and cannot be undone.\r\n                    </DialogContentText>\r\n                </DialogContent>\r\n                <DialogActions>\r\n                    <Button onClick={handleCloseDialog}>Cancel</Button>\r\n                    <Button onClick={handleConfirmDelete} color=\"error\" autoFocus>Delete</Button>\r\n                </DialogActions>\r\n            </Dialog>\r\n        </Box>\r\n    );\r\n}\r\nexport default PurchasesPage;"],"names":["suppliers","setSuppliers","useState","variants","setVariants","purchases","setPurchases","supplierName","setSupplierName","purchaseData","setPurchaseData","supplier","variant","quantity","purchase_price","dialogOpen","setDialogOpen","itemToDelete","setItemToDelete","fetchData","axios","get","then","res","data","sort","a","b","Date","purchase_date","useEffect","handleCloseDialog","getVariantName","id","find","v","concat","product_name","name","handleInputChange","e","_objectSpread","target","value","_jsxs","Box","children","_jsx","Typography","gutterBottom","Grid","container","spacing","item","xs","md","Card","CardContent","component","onSubmit","preventDefault","post","toast","success","sx","display","gap","TextField","label","onChange","required","fullWidth","Button","type","flexDirection","FormControl","InputLabel","Select","map","s","MenuItem","List","p","ListItem","secondaryAction","IconButton","edge","onClick","handleOpenDialog","DeleteIcon","color","ListItemText","primary","secondary","toLocaleDateString","Dialog","open","onClose","DialogTitle","DialogContent","DialogContentText","DialogActions","handleConfirmDelete","delete","catch","err","error","console","finally","autoFocus"],"sourceRoot":""}