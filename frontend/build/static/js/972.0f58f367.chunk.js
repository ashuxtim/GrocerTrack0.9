"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[972],{1972:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var n=a(9379),r=a(5043),s=a(9722),l=a(7488),i=a(1244),c=a(6128),o=a(5895),d=a(998),u=a(3969),h=a(6923),p=a(6154),m=a(4527),x=a(256),A=a(9067),j=a(4481),v=a(7471),g=a(2097),f=a(5315),y=a(2394),_=a(6185),S=a(579);const b=function(){const[e,t]=(0,r.useState)([]),[a,b]=(0,r.useState)([]),[C,q]=(0,r.useState)(null),[k,B]=(0,r.useState)([]),[w,P]=(0,r.useState)(""),[R,F]=(0,r.useState)(1);(0,r.useEffect)(()=>{s.A.get("http://localhost:8000/api/customers/").then(e=>t(e.data)),s.A.get("http://localhost:8000/api/variants/").then(e=>b(e.data))},[]);const I=k.reduce((e,t)=>e+t.quantity*t.price_at_sale,0);return(0,S.jsx)(i.A,{children:(0,S.jsxs)(c.A,{children:[(0,S.jsx)(o.A,{variant:"h2",gutterBottom:!0,children:"\ud83d\udcdd Add New Credit Sale"}),(0,S.jsxs)(d.A,{container:!0,spacing:3,children:[(0,S.jsxs)(d.A,{item:!0,xs:12,md:5,children:[(0,S.jsx)(o.A,{variant:"h3",gutterBottom:!0,children:"1. Add Items to Bill"}),(0,S.jsxs)(u.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,S.jsx)(h.A,{options:e,getOptionLabel:e=>e.name,value:C,onChange:(e,t)=>{q(t)},renderInput:e=>(0,S.jsx)(p.A,(0,n.A)((0,n.A)({},e),{},{label:"Search for a Customer",required:!0}))}),(0,S.jsx)(m.A,{sx:{my:1}}),(0,S.jsxs)(x.A,{fullWidth:!0,children:[(0,S.jsx)(A.A,{children:"Product"}),(0,S.jsx)(j.A,{value:w,label:"Product",onChange:e=>P(e.target.value),children:a.map(e=>(0,S.jsxs)(v.A,{value:e.id,children:[e.product_name," (",e.name,")"]},e.id))})]}),(0,S.jsx)(p.A,{label:"Quantity",type:"number",value:R,onChange:e=>F(e.target.value),min:"0.1",step:"0.1"}),(0,S.jsx)(g.A,{variant:"outlined",onClick:()=>{const e=a.find(e=>e.id===parseInt(w));if(e&&R>0){const t={variant:e.id,variant_name:"".concat(e.product_name," (").concat(e.name,")"),quantity:parseFloat(R),price_at_sale:e.price};B([...k,t]),P(""),F(1)}else l.oR.warn("Please select a valid product and quantity.")},children:"Add to Bill"})]})]}),(0,S.jsxs)(d.A,{item:!0,xs:12,md:7,children:[(0,S.jsx)(o.A,{variant:"h3",gutterBottom:!0,children:"2. Current Bill"}),(0,S.jsx)(f.A,{children:k.map((e,t)=>(0,S.jsx)(y.Ay,{children:(0,S.jsx)(_.A,{primary:e.variant_name,secondary:"Qty: ".concat(e.quantity," @ \u20b9").concat(e.price_at_sale)})},t))}),(0,S.jsx)(m.A,{}),(0,S.jsxs)(o.A,{variant:"h5",align:"right",sx:{mt:2,mr:2},children:["Total: \u20b9",I.toFixed(2)]}),(0,S.jsx)(g.A,{variant:"contained",color:"primary",fullWidth:!0,sx:{mt:2},onClick:()=>{if(!C||0===k.length)return void l.oR.error("Please select a customer and add items to the bill.");const e={customer:C.id,items:k.map(e=>{let{variant:t,quantity:a,price_at_sale:n}=e;return{variant:t,quantity:a,price_at_sale:n}})};s.A.post("http://localhost:8000/api/sales/",e).then(()=>{l.oR.success("Sale recorded successfully!"),B([]),q(null)}).catch(e=>{console.error("Error recording sale:",e.response.data),l.oR.error("Failed to record sale.")})},disabled:!C||0===k.length,children:"Submit Sale"})]})]})]})})}}}]);
//# sourceMappingURL=972.0f58f367.chunk.js.map