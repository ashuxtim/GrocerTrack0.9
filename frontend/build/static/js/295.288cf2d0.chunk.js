"use strict";(self.webpackChunkfrontend=self.webpackChunkfrontend||[]).push([[295],{295:(e,t,r)=>{r.r(t),r.d(t,{default:()=>z});var n=r(9379),a=r(5043),o=r(9722),c=r(7488),s=r(3759),i=r(6647),l=r(3969),d=r(998),u=r(5895),h=r(1244),m=r(6128),x=r(6923),p=r(6154),A=r(256),j=r(9067),v=r(4481),f=r(7471),g=r(2097),b=r(5315),k=r(2394),y=r(6185),C=r(3023),N=r(1911),S=r(8776),w=r(9200),P=r(5877),_=r(8549),I=r(6347),R=r(1773),W=r(5362),B=r(9059),D=r(579);const V={position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",width:400,bgcolor:"background.paper",boxShadow:24,p:4,borderRadius:2},q={productName:"",variantName:"",price:"",unit:"piece",current_stock:0};const z=function(){const[e,t]=(0,a.useState)([]),[r,z]=(0,a.useState)(null),[L,U]=(0,a.useState)({price:"",current_stock:""}),[E,F]=(0,a.useState)(q),[M,O]=(0,a.useState)(!1),[G,H]=(0,a.useState)(null),K=()=>{o.A.get("http://localhost:8000/api/products/").then(e=>t(e.data))};(0,a.useEffect)(()=>{K()},[]);const T=e.flatMap(e=>e.variants.map(t=>({id:t.id,productName:e.name,variantName:t.name,price:t.price,currentStock:t.current_stock,unit:t.unit,fullVariant:t}))),J=(e,t,r)=>{H({id:e,type:t,name:r}),O(!0)},Q=()=>{O(!1),H(null)},X=e=>{F((0,n.A)((0,n.A)({},E),{},{[e.target.name]:e.target.value}))},Y=[{field:"productName",headerName:"Product",flex:1},{field:"variantName",headerName:"Variant",flex:1},{field:"price",headerName:"Price (\u20b9)",type:"number",flex:.5},{field:"currentStock",headerName:"Stock",type:"number",flex:.5},{field:"status",headerName:"Status",flex:.7,renderCell:e=>{const t=e.row.currentStock;let r,n;return t<=0?(r="Out of Stock",n="error"):t<=10?(r="Low Stock",n="warning"):(r="In Stock",n="success"),(0,D.jsx)(s.A,{label:r,color:n,size:"small"})}},{field:"actions",headerName:"Actions",type:"actions",flex:.5,getActions:e=>[(0,D.jsx)(i.A,{onClick:()=>{return t=e.row,z(t.fullVariant),void U({price:t.price,current_stock:t.currentStock});var t},children:(0,D.jsx)(R.A,{})}),(0,D.jsx)(i.A,{onClick:()=>J(e.id,"variant",e.row.variantName),children:(0,D.jsx)(W.A,{color:"error"})})]}],Z=e.map(e=>({label:e.name}));return(0,D.jsxs)(l.A,{children:[(0,D.jsxs)(d.A,{container:!0,spacing:3,children:[(0,D.jsxs)(d.A,{item:!0,xs:12,md:8,children:[(0,D.jsx)(u.A,{variant:"h2",gutterBottom:!0,children:"\ud83d\udce6 Product Inventory"}),(0,D.jsx)(h.A,{sx:{mb:3},children:(0,D.jsxs)(m.A,{children:[(0,D.jsx)(u.A,{variant:"h3",gutterBottom:!0,children:"Add New Product"}),(0,D.jsx)(l.A,{component:"form",onSubmit:t=>{let r;t.preventDefault();const n=e.find(e=>e.name.toLowerCase()===E.productName.toLowerCase());r=n?Promise.resolve({data:n}):o.A.post("http://localhost:8000/api/products/",{name:E.productName}),r.then(e=>{const t={product:e.data.id,name:E.variantName,price:E.price,unit:E.unit,current_stock:E.current_stock};return o.A.post("http://localhost:8000/api/variants/",t)}).then(()=>{c.oR.success("New product added successfully!"),F(q),K()}).catch(e=>{c.oR.error("Failed to add product."),console.error(e)})},children:(0,D.jsxs)(d.A,{container:!0,spacing:2,alignItems:"center",children:[(0,D.jsx)(d.A,{item:!0,xs:12,children:(0,D.jsx)(x.A,{freeSolo:!0,options:Z,value:E.productName,onInputChange:(e,t)=>{F((0,n.A)((0,n.A)({},E),{},{productName:t}))},renderInput:e=>(0,D.jsx)(p.A,(0,n.A)((0,n.A)({},e),{},{label:"Product Name (Select existing or type a new one)",required:!0}))})}),(0,D.jsx)(d.A,{item:!0,xs:12,sm:6,children:(0,D.jsx)(p.A,{name:"variantName",label:"Variant Name",value:E.variantName,onChange:X,required:!0,fullWidth:!0})}),(0,D.jsx)(d.A,{item:!0,xs:12,sm:6,children:(0,D.jsx)(p.A,{name:"price",label:"Price",type:"number",value:E.price,onChange:X,required:!0,fullWidth:!0})}),(0,D.jsx)(d.A,{item:!0,xs:12,sm:4,children:(0,D.jsxs)(A.A,{fullWidth:!0,children:[(0,D.jsx)(j.A,{children:"Unit"}),(0,D.jsxs)(v.A,{name:"unit",value:E.unit,label:"Unit",onChange:X,children:[(0,D.jsx)(f.A,{value:"piece",children:"Piece"}),(0,D.jsx)(f.A,{value:"kg",children:"Kilogram"}),(0,D.jsx)(f.A,{value:"packet",children:"Packet"}),(0,D.jsx)(f.A,{value:"litre",children:"Litre"})]})]})}),(0,D.jsx)(d.A,{item:!0,xs:12,sm:4,children:(0,D.jsx)(p.A,{name:"current_stock",label:"Initial Stock",type:"number",value:E.current_stock,onChange:X,required:!0,fullWidth:!0})}),(0,D.jsx)(d.A,{item:!0,xs:12,sm:4,children:(0,D.jsx)(g.A,{type:"submit",variant:"contained",fullWidth:!0,size:"large",children:"Add Product"})})]})})]})}),(0,D.jsx)(h.A,{children:(0,D.jsx)(l.A,{sx:{height:600,width:"100%"},children:(0,D.jsx)(I.z,{rows:T,columns:Y,slots:{noRowsOverlay:()=>(0,D.jsx)(B.A,{title:"No Products",message:"Get started by adding a new product."})}})})})]}),(0,D.jsxs)(d.A,{item:!0,xs:12,md:4,children:[(0,D.jsx)(u.A,{variant:"h2",gutterBottom:!0,sx:{color:"transparent",userSelect:"none"},children:"."}),(0,D.jsx)(h.A,{children:(0,D.jsxs)(m.A,{children:[(0,D.jsx)(u.A,{variant:"h3",gutterBottom:!0,children:"Manage Categories"}),e.length>0?(0,D.jsx)(b.A,{children:e.map(e=>(0,D.jsx)(k.Ay,{secondaryAction:(0,D.jsx)(i.A,{edge:"end",onClick:()=>J(e.id,"product",e.name),children:(0,D.jsx)(W.A,{color:"error"})}),children:(0,D.jsx)(y.A,{primary:e.name,secondary:"".concat(e.variants.length," variant(s)")})},e.id))}):(0,D.jsx)(u.A,{sx:{mt:2,textAlign:"center",color:"text.secondary"},children:"No product categories yet."})]})})]})]}),(0,D.jsx)(_.A,{open:!!r,onClose:()=>z(null),children:(0,D.jsxs)(l.A,{sx:V,component:"form",onSubmit:e=>{e.preventDefault();const t=(0,n.A)((0,n.A)({},r),L);o.A.put("http://localhost:8000/api/variants/".concat(r.id,"/"),t).then(()=>{c.oR.success("Variant updated!"),z(null),K()})},children:[(0,D.jsxs)(u.A,{variant:"h6",component:"h2",gutterBottom:!0,children:["Edit ",null===r||void 0===r?void 0:r.name]}),(0,D.jsx)(p.A,{label:"Price",type:"number",value:L.price,onChange:e=>U((0,n.A)((0,n.A)({},L),{},{price:e.target.value})),fullWidth:!0,sx:{mb:2}}),(0,D.jsx)(p.A,{label:"Current Stock",type:"number",value:L.current_stock,onChange:e=>U((0,n.A)((0,n.A)({},L),{},{current_stock:e.target.value})),fullWidth:!0,sx:{mb:2}}),(0,D.jsx)(g.A,{type:"submit",variant:"contained",children:"Save Changes"})]})}),(0,D.jsxs)(C.A,{open:M,onClose:Q,children:[(0,D.jsx)(N.A,{children:"Confirm Deletion"}),(0,D.jsx)(S.A,{children:(0,D.jsxs)(w.A,{children:["Are you sure you want to delete the ",null===G||void 0===G?void 0:G.type,' "',null===G||void 0===G?void 0:G.name,'"? This action cannot be undone.']})}),(0,D.jsxs)(P.A,{children:[(0,D.jsx)(g.A,{onClick:Q,children:"Cancel"}),(0,D.jsx)(g.A,{onClick:()=>{if(!G)return;const{id:e,type:t}=G;let r;r="product"===t?o.A.delete("http://localhost:8000/api/products/".concat(e,"/")):o.A.delete("http://localhost:8000/api/variants/".concat(e,"/")),r.then(()=>{c.oR.success("".concat(t.charAt(0).toUpperCase()+t.slice(1)," deleted.")),K()}).catch(()=>{c.oR.error("Could not delete. It may be part of a sale record.")}).finally(()=>{Q()})},color:"error",autoFocus:!0,children:"Delete"})]})]})]})}},9059:(e,t,r)=>{r.d(t,{A:()=>s});r(5043);var n=r(3969),a=r(5895),o=r(6705),c=r(579);const s=e=>{let{title:t,message:r}=e;return(0,c.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center",p:3,height:"100%",minHeight:200,color:"text.secondary"},children:[(0,c.jsx)(o.A,{sx:{fontSize:60,mb:2,color:"neutral.main"}}),(0,c.jsx)(a.A,{variant:"h6",component:"p",gutterBottom:!0,children:t}),(0,c.jsx)(a.A,{variant:"body1",children:r})]})}}}]);
//# sourceMappingURL=295.288cf2d0.chunk.js.map